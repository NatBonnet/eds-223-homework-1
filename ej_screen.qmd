---
title: "EDS 223: Homework 1"
subtitle: "Evaluating the Respiratory Health Index For Puerto Rico and Hawaii"
author: "Nathalie Bonnet"
date: 2025-10-6
format: docx
warning: FALSE
---

```{r}
# Read in necessary libraries
library(tidyverse)
library(sf)
library(here)
library(tmap)
```


```{r}
# read in geodatabase of EJScreen data at the Census Block Group level
ejscreen <- sf::st_read(here::here("data", "ejscreen","EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 
```


```{r}
# Subsetting to explore low income data by state
mean_low_income <- ejscreen %>% 
  group_by(STATE_NAME) %>% 
  summarise(mean_percent_low_income = mean(LOWINCPCT)) %>% 
  drop_na(mean_percent_low_income)
```


```{r}
# Finding the states/ territories with the lowest average percent low income
lowest_mean_poverty <- mean_low_income %>%
  slice_min(mean_percent_low_income, n = 5) %>%
  select(STATE_NAME, mean_percent_low_income)

head(lowest_mean_poverty, 3) # Showing the state/territory with the lowest average low income percentage
```

```{r}
# Finding the states/ territories with the highest average percent low income
highest_mean_poverty <- mean_low_income %>%
  slice_max(mean_percent_low_income, n = 5) %>%
  select(STATE_NAME, mean_percent_low_income)

head(highest_mean_poverty, 1) # Showing the state/territory with the highest average low income percentage
```
The territory with the highest mean percent low income is Puerto Rico

# Once you find the highest and lowest % low income make two subsets of data for these and aggregate income data by county and map to visualize 

# After that do the same process for cancer risk


```{r}
# Filtering for only observation in Hawaii
hawaii <- ejscreen %>%
  filter(STATE_NAME == "Hawaii") %>% 
  filter(ACSTOTPOP > 0)
```

```{r}
# Filtering for only observations in Puerto Rico
puerto_rico <- ejscreen %>%
  filter(STATE_NAME == "Puerto Rico") %>% 
  filter(ACSTOTPOP > 0)
```


```{r}
tmap::tm_shape(puerto_rico) +
  tm_graticules() +
  tm_polygons(fill = "RESP", 
              title = "Respiratory Hazard Index",
              breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), 
              palette = "brewer.yl_or_br") + 
  tm_borders(col = "grey") +
  tm_title("Respiratory Health Index Values in Puerto Rico") +
  tm_scalebar(position = c("right", "bottom"), 
              text.size = 0.2) +
  tm_legend(position = tm_pos_out("right")) +
  tm_compass()
```


```{r}

tmap::tm_shape(hawaii) +
  tm_graticules() +
  tm_polygons(fill = "RESP", 
              title = "Respiratory Hazard Index",
              breaks = c(0, 0.1, 0.2, 0.3, 0.4, 0.5), 
              palette = "brewer.yl_or_br") + 
             tm_borders(col = "grey") +
  tm_scalebar(position = c("left", "bottom"), 
              text.size = 0.3) +
tm_legend(position = tm_pos_out("right")) +
  tm_compass(position = "right")
```
